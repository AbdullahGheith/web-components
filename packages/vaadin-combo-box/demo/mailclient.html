<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">

  <title>vaadin-combo-box demo</title>

  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../polymer/polymer.html">
  <link rel="import" href="../../paper-input/paper-input.html">
  <link rel="import" href="../../paper-button/paper-button.html">
  <link rel="import" href="../../paper-input/paper-textarea.html">
  <link rel="import" href="../../paper-toast/paper-toast.html">
  <link rel="import" href="../vaadin-combo-box.html">

</head>

<body unresolved>

  <template is="dom-bind">
    <style is="custom-style">
      .horizontal {
        @apply(--layout-horizontal);
      }

      body {
        font-family: 'Roboto', 'Noto', sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        font-size: 16px;
        font-weight: 400;
        line-height: 24px;
      }

      #result {
        margin-top: 100px;
      }

      span[suggestion] {
        font-style: italic;
      }
    </style>

    <div class="horizontal">
      <vaadin-combo-box style="width: 60%" label="To" value={{email}} items="[[addresses]]">
        <template>
          <template is="dom-if" if=[[item.suggestion]]>
            <span suggestion>[[item.value]]</span>
          </template>
          <template is="dom-if" if=[[!item.suggestion]]>
            <span>[[item.value]]</span>
          </template>
        </template>

        <template class="selected-template">
          <span>[[item.value]]</span>
        </template>
      </vaadin-combo-box>
      <vaadin-combo-box style="width: 40%" label="Priority" value={{priority}} items="[[priorities]]"></vaadin-combo-box>
    </div>

    <paper-input value={{subject}} label="Subject"></paper-input>
    <paper-textarea label="Body" rows=4 value={{mailbody}} style="width: 100%;"></paper-textarea>
    <paper-button raised on-click="send">Send</paper-button>

    <div id="result">
      <div><b>To:</b>&nbsp;<span>[[email]]</span></div>
      <div><b>Priority:</b>&nbsp;<span>[[priority]]</span></div>
      <div><b>Subject:</b>&nbsp;<span>[[subject]]</span></div>
      <div><b>Body:</b>&nbsp;<span>[[mailbody]]</span></div>
    </div>
  </template>

  <paper-toast id="toast" text="Mail sent"></paper-toast>

  <script>
    HTMLImports.whenReady(function() {
      var template = document.querySelector("template");

      template.priorities = ["High", "Medium", "Low"];

      template.addresses = function(req) {
        var filtered = [];

        //History
        ["jouni@vaadin.com", "virkki@vaadin.com", "tepi@vaadin.com", "tuomas@vaadin.com"].forEach(function(addr) {
          if (addr.indexOf(req.filter) === 0 || !req.filter) {
            filtered.push({value: addr});
          }
        });

        if (req.filter) {
          ["@vaadin.com", "@gmail.com"].forEach(function(suffix) {
            var addr = req.filter + suffix;
            var alreadyContains = filtered.filter(function(val){return val == addr}).length > 0;
            if (!alreadyContains) {
              filtered.push({value : req.filter + suffix, suggestion: true});
            }
          });
        }

        req.success(filtered.slice(req.index, req.index + req.count), filtered.length);
      };

      template.send = function() {
        template.email = undefined;
        template.priority = undefined;
        template.subject = undefined;
        template.mailbody = "";
        document.getElementById("toast").show();
      }

    });
  </script>

</body>

</html>
