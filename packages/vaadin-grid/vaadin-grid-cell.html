<dom-module id="vaadin-grid-cell">
  <template>
    <style>
      ::content > div {
        padding: 8px;
      }
    </style>

    <content></content>
  </template>
  <script>
    Polymer({
      is: 'vaadin-grid-cell',

      extends: 'td',

      behaviors: [
        Polymer.Templatizer
      ],

      properties: {
        column: Object,
        instance: Object,
        index: Number,
        template: Object,
        target: Object
      },

      observers: ['_columnChanged(column)', '_templateChanged(template, target)', '_indexChanged(index, instance)'],

      _columnChanged: function(column) {
        this.style.flexBasis = column.minWidth || column.width;
      },

      _indexChanged: function(index, instance) {
        instance.index = index;
      },

      _templateChanged: function(template, target) {
        if (template) {
          this.templatize(template);
          this.instance = this.stamp(null);

          var item = document.createElement('div');
          var itemClass = 'item-' + target.childElementCount;
          item.classList.add(itemClass);

          if (Polymer.Settings.useShadow) {

            Polymer.dom(target).appendChild(item);

            var content = document.createElement('content');
            content.setAttribute('select', '.' + itemClass);
            Polymer.dom(this).appendChild(content);

          } else {
            // Non-shadow
            Polymer.dom(this).appendChild(item);
          }
          Polymer.dom(item).appendChild(this.instance.root);
        }
      }


    });
  </script>
</dom-module>
