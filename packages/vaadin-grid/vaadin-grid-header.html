<link rel="import" href="vaadin-grid-header-row.html">

<dom-module id="vaadin-grid-header">
  <script>
    Polymer({
      is: 'vaadin-grid-header',
      extends: 'thead',

      properties: {
        columns: Array,
        frozenColumns: Number,
        _rows: Array
      },

      observers: ['_columnsChanged(columns)', '_frozenColumnsChanged(frozenColumns, _rows)'],

      _columnsChanged: function(columns, frozenColumns) {
        var rows = [];
        columns.forEach(function(column, columnIndex) {
          column.headers.forEach(function(header, headerIndex) {
            var headerRow = this.childNodes[headerIndex];
            if (!headerRow) {
              headerRow = document.createElement('tr', 'vaadin-grid-header-row');
              headerRow.headerIndex = headerIndex;
              // TODO: correct target should be the same scope as the templates were
              // introduced. (consider encapsulated parent of vaadin-grid)
              headerRow.target = this.domHost.domHost; //vaadin-grid
              headerRow.columns = columns;

              Polymer.dom(this).appendChild(headerRow);
              rows.push(headerRow);
            }
          }, this);
        }, this);

        this._rows = rows;
      },

      _frozenColumnsChanged: function(frozenColumns, rows) {
        rows.forEach(function(row) {
          row.frozenColumns = frozenColumns;
        })
      }
    });
  </script>
</dom-module>
