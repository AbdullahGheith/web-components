<script>
  window.vaadin = window.vaadin || {};
  vaadin.elements = vaadin.elements || {};
  vaadin.elements.grid = vaadin.elements.grid || {};

  vaadin.elements.grid.GridColumnsBehaviorImpl = {
    properties: {
      columns: Array
    },

    observers: [
      '_columnsChanged(columns, frozenColumns, _physicalCount, _physicalItems)'
    ],

    // TODO: we should observe _physicalItems.splices instead of _physicalCount
    _columnsChanged: function(columns, frozenColumns) {
      this._physicalItems.forEach(function(row) {
        row.columns = columns;
        row.frozenColumns = frozenColumns;
      });

      requestAnimationFrame(function() {
        this.$.outerscroller.style.paddingTop = this.$.table.style.paddingTop = this.$.header.clientHeight + 'px';
      }.bind(this));
    }
  };

  vaadin.elements.grid.GridColumnsBehavior = [
    vaadin.elements.grid.GridColumnsBehaviorImpl
  ];
</script>
