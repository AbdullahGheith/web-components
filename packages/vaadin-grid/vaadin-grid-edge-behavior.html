<dom-module is="vaadin-grid-edge-styles">
  <template>
    <style>
      :host([edge]) {
        /* Any value other than ‘none’ for the transform results in the creation of both a stacking context and
        a containing block. The object acts as a containing block for fixed positioned descendants. */
        transform: translateZ(0);
        overflow: hidden;
      }

      :host([edge]) #header {
        position: fixed;
        transform: translateZ(0);
      }

      :host([edge]) #items {
        position: fixed;
        width: 100%;
        transform: translateZ(0);
        will-change: transform;
      }
    </style>
  </template>
</dom-module>

<script>
  window.vaadin = window.vaadin || {};
  vaadin.elements = vaadin.elements || {};
  vaadin.elements.grid = vaadin.elements.grid || {};

  vaadin.elements.grid.EdgeBehavior = {

    hostAttributes: {
      edge: true
    },

    _onScroll: function() {
      // TODO: Cache queries
      Polymer.dom(this.root).querySelectorAll('tbody [frozen]').forEach(function(cell) {
        cell.style.transform = this._getTranslate3d(this._scrollLeft, 0);
      }, this);

      Polymer.dom(this.root).querySelectorAll('thead th:not([frozen])').forEach(function(cell) {
        cell.style.transform = this._getTranslate3d(-this._scrollLeft, 0);
      }, this);

      this.$.items.style.transform =
        this._getTranslate3d(-this._scrollLeft || 0, -this._scrollPosition || 0);
    }

  };
</script>
