<link rel="import" href="vaadin-grid-cell.html">

<dom-module id="vaadin-grid-row">
  <script>
    Polymer({
      is: 'vaadin-grid-row',
      extends: 'tr',

      properties: {
        columns: Array,
        index: Number,
        cells: {
          value: []
        },
        frozenColumns: Number,
        target: Object
      },

      observers: ['_columnsChanged(columns, target)', '_indexChanged(index, cells)', '_frozenColumnsChanged(frozenColumns, cells)'],

      //TODO: implement support for columns.splices
      _columnsChanged: function(columns, target) {
        this.cells.forEach(function(cell) {
          Polymer.dom(this).removeChild(cell);
        }, this);

        var cells = [];

        columns.forEach(function(column) {
          var cell = document.createElement('td', 'vaadin-grid-cell');
          cell.index = this.index;
          cell.target = this.target;
          cell.column = column;
          cell.template = column.template;

          Polymer.dom(this).appendChild(cell);

          cells.push(cell);
        }.bind(this));

        this.cells = cells;
      },

      _frozenColumnsChanged: function(frozenColumns, cells) {
        cells.forEach(function(cell, i) {
          cell.toggleAttribute('frozen', i < frozenColumns);
          cell.toggleAttribute('last-frozen', i === frozenColumns - 1);
        });
      },

      _indexChanged: function(index, cells) {
        this.toggleAttribute('odd', index % 2);
        cells.forEach(function(cell) {
          cell.index = index;
        });
      }
    });
  </script>
</dom-module>
